select
	t.pool_id,
	t.tick_index,
	trunc(t.constant_price0 * 1000000000000, 6) as p0_DAI_100, -- 1,000,000,000,000
	trunc(t.constant_price1 / 1000000000000, 6) as p1_USDC_100,
	h.days_in_tick
from univ3.pool_ticks t
left join (
	select pool_id, tick_index, count(*) as days_in_tick
	from univ3.pool_history
	group by pool_id, tick_index
	--having count(*) > 1
) h on h.pool_id = t.pool_id and h.tick_index = t.tick_index 
where t.pool_id = '0x5777d92f208679db4b9778590fa3cab3ac9e2168'
--and t.tick_index not in ('-887272', '887272') --> -276324
order by 1,2;



/*

------------------------------------------+----------+--------+--------+
pool_id                                   |tick_index|p0_dai  |p1_usdc |
------------------------------------------+----------+--------+--------+
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -298430|0.109647|9.120155|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -290189|0.249966|4.000534|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -290188|0.249991|4.000134|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -290186|0.250041|3.999334|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276526|0.980006|1.020401|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276525|0.980104|1.020299|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276424|0.990052|1.010046|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276414|0.991043|1.009037|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276386|0.993822|1.006216|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276378|0.994617|1.005411|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276374|0.995015|1.005009|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276365|0.995911|1.004105|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276356|0.996807|1.003202|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276350|0.997406|1.002600|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276348|0.997605|1.002400|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276345|0.997904|1.002099|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276344|0.998004|1.001999|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276340|0.998403|1.001598|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276337|0.998703|1.001298|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276336|0.998803|1.001198|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276335|0.998903|1.001097|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276334|0.999003|1.000997|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276333|0.999103|1.000897|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276332|0.999203|1.000797|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276331|0.999302|1.000697|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276330|0.999402|1.000597|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276329|0.999502|1.000497|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276328|0.999602|1.000397|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276327|0.999702|1.000297|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276326|0.999802|1.000197|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276325|0.999902|1.000097|
------------------------------------------+----------+--------+--------+
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276324|1.000002|0.999997| <<<
------------------------------------------+----------+--------+--------+
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276323|1.000102|0.999897|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276322|1.000202|0.999797|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276321|1.000302|0.999697|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276320|1.000402|0.999597|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276319|1.000502|0.999497|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276318|1.000602|0.999397|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276317|1.000702|0.999297|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276316|1.000802|0.999197|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276315|1.000903|0.999097|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276314|1.001003|0.998997|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276313|1.001103|0.998898|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276312|1.001203|0.998798|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276311|1.001303|0.998698|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276309|1.001503|0.998498|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276306|1.001804|0.998199|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276305|1.001904|0.998099|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276304|1.002004|0.997999|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276289|1.003508|0.996503|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276287|1.003709|0.996304|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276286|1.003809|0.996204|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276274|1.005014|0.995010|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276254|1.007026|0.993022|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276224|1.010052|0.990047|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276126|1.019999|0.980393|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276124|1.020203|0.980197|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -276123|1.020305|0.980099|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -262461|3.999755|0.250015|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -262460|4.000155|0.249990|
0x5777d92f208679db4b9778590fa3cab3ac9e2168|   -254218|9.120203|0.109646|

*/
